<!DOCTYPE html><html lang="es" data-astro-cid-sckkx6r4> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="generator" content="Astro v5.5.5"><link rel="icon" type="image/svg+xml" href="/dados-bot/favicon.svg"><link rel="stylesheet" href="../styles/global.css"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Big+Shoulders+Stencil:opsz,wght@10..72,100..900&display=swap" rel="stylesheet"><title>3D20</title><link rel="stylesheet" href="/dados-bot/_astro/index.TbLMlsTM.css"></head> <body data-astro-cid-sckkx6r4> <main data-astro-cid-sckkx6r4>  <div class="container" data-astro-cid-j7pv25f6> <div class="row" data-astro-cid-j7pv25f6> <div class="header-content mb-3" data-astro-cid-j7pv25f6> <div class="header-content__left" data-astro-cid-j7pv25f6> <button id="backwhurl" class="mt-0" onclick="resetWebhookConfig()" data-astro-cid-j7pv25f6>Nuevo Webhook</button> </div> <div class="header-content__right flex" data-astro-cid-j7pv25f6> <div class="header-content__right--info" data-astro-cid-j7pv25f6> <button onclick="document.getElementById('modalInfoCustomJson').showModal()" data-astro-cid-j7pv25f6> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-6" data-astro-cid-j7pv25f6> <path fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm8.706-1.442c1.146-.573 2.437.463 2.126 1.706l-.709 2.836.042-.02a.75.75 0 0 1 .67 1.34l-.04.022c-1.147.573-2.438-.463-2.127-1.706l.71-2.836-.042.02a.75.75 0 1 1-.671-1.34l.041-.022ZM12 9a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z" clip-rule="evenodd" data-astro-cid-j7pv25f6></path> </svg> </button> <dialog id="modalInfoCustomJson" class="fixed inset-0 backdrop:bg-black/50 invisible open:visible p-10 max-w-2xl bg-gray-900 border-blue-500 border" data-astro-cid-j7pv25f6> <div class="rounded-lg" data-astro-cid-j7pv25f6> <h2 class="text-xl font-bold mb-4 text-white" data-astro-cid-j7pv25f6>
Formato de JSON para Skills Personalizadas
</h2> <p class="mb-4 text-white" data-astro-cid-j7pv25f6>
El archivo JSON debe tener el siguiente formato:
</p> <pre class="bg-gray-800 p-4 rounded mb-4 overflow-auto max-h-60 text-white" data-astro-cid-j7pv25f6>{
  &quot;config&quot;: {
    &quot;title&quot;: &quot;🌟 INFORME DEL SALOON&quot;,
    &quot;characterLabel&quot;: &quot;Cowboy&quot;,
    &quot;defaultAnalysis&quot;: &quot;El vaquero reaccionó como pudo&quot;,
    &quot;defaultRecommendation&quot;: &quot;Más práctica en el saloon&quot;
  },
  &quot;skills&quot;: [
    {
      &quot;name&quot;: &quot;Tiro rápido 🤠&quot;,
      &quot;messages&quot;: [
        &quot;¡El revólver se encasquilló!&quot;,
        &quot;Disparo al aire&quot;,
        &quot;Rozó al oponente&quot;,
        &quot;Disparo certero&quot;,
        &quot;¡Disparo legendario!&quot;
      ],
      &quot;analysis&quot;: [
        &quot;Desastre total en el duelo&quot;,
        &quot;Necesita practicar más&quot;,
        &quot;Casi lo logra&quot;,
        &quot;Buen trabajo&quot;,
        &quot;¡Leyenda del Oeste!&quot;
      ],
      &quot;recommendations&quot;: [
        &quot;Ve a ver al herrero&quot;,
        &quot;Entrena con el sheriff&quot;,
        &quot;Un poco más de práctica&quot;,
        &quot;Sigue así&quot;,
        &quot;¡Eres una leyenda!&quot;
      ]
    }
  ]
}
									</pre> <div class="flex mt-6 header-content__right--dialog-buttons" data-astro-cid-j7pv25f6> <button onclick="copiarJsonBase()" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 icon ml-auto" title="copiar" data-astro-cid-j7pv25f6> <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6" data-astro-cid-j7pv25f6> <path stroke-linecap="round" stroke-linejoin="round" d="M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 0 0 2.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 0 0-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75 2.25 2.25 0 0 0-.1-.664m-5.8 0A2.251 2.251 0 0 1 13.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25ZM6.75 12h.008v.008H6.75V12Zm0 3h.008v.008H6.75V15Zm0 3h.008v.008H6.75V18Z" data-astro-cid-j7pv25f6></path> </svg> </button> <button onclick="document.getElementById('modalInfoCustomJson').close()" class="px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 icon ml-5" title="Cerrar" data-astro-cid-j7pv25f6> <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6" data-astro-cid-j7pv25f6> <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" data-astro-cid-j7pv25f6></path> </svg> </button> </div> </div> </dialog> </div> <div class="header-content__right--load" data-astro-cid-j7pv25f6> <label for="loadJson" class="button flex justify-between" data-astro-cid-j7pv25f6>
Custom Upload &nbsp;
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5" data-astro-cid-j7pv25f6> <path stroke-linecap="round" stroke-linejoin="round" d="M9 8.25H7.5a2.25 2.25 0 0 0-2.25 2.25v9a2.25 2.25 0 0 0 2.25 2.25h9a2.25 2.25 0 0 0 2.25-2.25v-9a2.25 2.25 0 0 0-2.25-2.25H15m0-3-3-3m0 0-3 3m3-3V15" data-astro-cid-j7pv25f6></path> </svg> </label> <input id="loadJson" type="file" accept=".json,application/json" class="hidden" data-astro-cid-j7pv25f6> </div> </div> </div> <div class="main-content" data-astro-cid-j7pv25f6> <h1 class="text-5xl text-center" data-astro-cid-j7pv25f6> <svg class="m-auto stroke-white" xmlns="http://www.w3.org/2000/svg" fill="#00a2ff" width="100px" height="100px" viewBox="-16 0 512 512" data-astro-cid-j7pv25f6><path d="M106.75 215.06L1.2 370.95c-3.08 5 .1 11.5 5.93 12.14l208.26 22.07-108.64-190.1zM7.41 315.43L82.7 193.08 6.06 147.1c-2.67-1.6-6.06.32-6.06 3.43v162.81c0 4.03 5.29 5.53 7.41 2.09zM18.25 423.6l194.4 87.66c5.3 2.45 11.35-1.43 11.35-7.26v-65.67l-203.55-22.3c-4.45-.5-6.23 5.59-2.2 7.57zm81.22-257.78L179.4 22.88c4.34-7.06-3.59-15.25-10.78-11.14L17.81 110.35c-2.47 1.62-2.39 5.26.13 6.78l81.53 48.69zM240 176h109.21L253.63 7.62C250.5 2.54 245.25 0 240 0s-10.5 2.54-13.63 7.62L130.79 176H240zm233.94-28.9l-76.64 45.99 75.29 122.35c2.11 3.44 7.41 1.94 7.41-2.1V150.53c0-3.11-3.39-5.03-6.06-3.43zm-93.41 18.72l81.53-48.7c2.53-1.52 2.6-5.16.13-6.78l-150.81-98.6c-7.19-4.11-15.12 4.08-10.78 11.14l79.93 142.94zm79.02 250.21L256 438.32v65.67c0 5.84 6.05 9.71 11.35 7.26l194.4-87.66c4.03-1.97 2.25-8.06-2.2-7.56zm-86.3-200.97l-108.63 190.1 208.26-22.07c5.83-.65 9.01-7.14 5.93-12.14L373.25 215.06zM240 208H139.57L240 383.75 340.43 208H240z" data-astro-cid-j7pv25f6></path></svg> </h1> <div id="webhook-form" data-astro-cid-j7pv25f6> <h3 data-astro-cid-j7pv25f6>⚙ CONFIGURACIÓN DEL SISTEMA</h3> <div class="form-group" data-astro-cid-j7pv25f6> <label for="webhook-url" data-astro-cid-j7pv25f6>ENLACE DE DISCORD WEBHOOK:</label> <input type="password" id="webhook-url" placeholder="https://discord.com/api/webhooks/..." data-astro-cid-j7pv25f6> </div> <button onclick="guardarWebhook()" data-astro-cid-j7pv25f6>INICIAR SISTEMA</button> </div> <div id="dados-section" style="display: none;" data-astro-cid-j7pv25f6> <h2 data-astro-cid-j7pv25f6>🚀 SIMULADOR DE HABILIDADES</h2> <div class="form-group" data-astro-cid-j7pv25f6> <label for="character-name" data-astro-cid-j7pv25f6>NOMBRE DEL PILOTO/TRIPULANTE:</label> <input type="text" id="character-name" placeholder="Ej: CMDR Shepard" data-astro-cid-j7pv25f6> </div> <div class="form-group" data-astro-cid-j7pv25f6> <label for="skill-name" data-astro-cid-j7pv25f6>HABILIDAD:</label> <select id="skill-name" data-astro-cid-j7pv25f6> <option value="Piloto ✈️" data-astro-cid-j7pv25f6>Piloto ✈️</option> <option value="Combate 🔫" data-astro-cid-j7pv25f6>Combate 🔫</option> <option value="Técnico 🛠️" data-astro-cid-j7pv25f6>Técnico 🛠️</option> <option value="Carisma 🗣️" data-astro-cid-j7pv25f6>Carisma 🗣️</option> <option value="Supervivencia 🌍" data-astro-cid-j7pv25f6>Supervivencia 🌍</option> <option value="Comercio 📦" data-astro-cid-j7pv25f6>Comercio 📦</option> </select> </div> <div class="form-group" data-astro-cid-j7pv25f6> <label for="skill-points" data-astro-cid-j7pv25f6>NIVEL DE HABILIDAD (1-6):</label> <input type="number" id="skill-points" min="1" max="6" value="3" data-astro-cid-j7pv25f6> </div> <button onclick="tirarDados()" data-astro-cid-j7pv25f6>⚡ EJECUTAR SIMULACIÓN</button> <div id="result" data-astro-cid-j7pv25f6></div> </div> </div> </div> </div>  </main> </body></html>  <script>
  // Configuración inicial
  let currentConfig = {
    title: "🌟 INFORME DE HABILIDAD",
    characterLabel: "Personaje",
    defaultAnalysis: "Resultado estándar de la acción",
    defaultRecommendation: "Sigue practicando para mejorar",
  };

  let currentSkills = [
    {
      name: "Piloto ✈️",
      messages: [
        "¡Impacto inminente!",
        "Error de navegación",
        "Aterrizaje forzoso",
        "Vuelo estable",
        "¡Acrobacias espaciales perfectas!",
      ],
      analysis: [
        "Desastre total en el vuelo",
        "Necesita más horas de práctica",
        "Aterrizaje aceptable",
        "Vuelo controlado",
        "Maniobras perfectas",
      ],
      recommendations: [
        "Revisar manual de vuelo",
        "Practicar en simulador",
        "Tomar lecciones adicionales",
        "Mantener el buen trabajo",
        "¡Eres un as del aire!",
      ],
    },
    {
      name: "Combate 🔫",
      messages: [
        "¡Arma encasquillada!",
        "Disparo errado",
        "Daño parcial",
        "Blanco neutralizado",
        "¡Disparo crítico!",
      ],
      analysis: [
        "Fallo catastrófico",
        "Necesita entrenamiento",
        "Resultado aceptable",
        "Buen desempeño",
        "Excelente puntería",
      ],
      recommendations: [
        "Revisar el arma",
        "Practicar puntería",
        "Mejorar técnica",
        "Mantener precisión",
        "¡Eres un francotirador!",
      ],
    },
  ];

  // Verificación inicial al cargar la página
  document.addEventListener("DOMContentLoaded", function () {
    const webhookURL = localStorage.getItem("discordWebhookURL");
    const backButton = document.getElementById("backwhurl");
    const webhookForm = document.getElementById("webhook-form");
    const dadosSection = document.getElementById("dados-section");

    if (webhookURL) {
      webhookForm.style.display = "none";
      dadosSection.style.display = "block";
      backButton.style.display = "block";

      // Actualizar dropdown con habilidades actuales
      actualizarDropdownHabilidades();
    } else {
      webhookForm.style.display = "block";
      dadosSection.style.display = "none";
      backButton.style.display = "none";
    }
  });

  function resetWebhookConfig() {
    // Limpiar el webhook almacenado
    localStorage.removeItem("discordWebhookURL");

    // Restablecer el campo de URL
    document.getElementById("webhook-url").value = "";

    // Mostrar el formulario de configuración
    document.getElementById("webhook-form").style.display = "block";

    // Ocultar la sección de habilidades
    document.getElementById("dados-section").style.display = "none";

    // Ocultar el botón "Nuevo Webhook"
    document.getElementById("backwhurl").style.display = "none";

    // Limpiar resultados anteriores
    document.getElementById("result").style.display = "none";
  }

  function actualizarDropdownHabilidades() {
    const skillSelect = document.getElementById("skill-name");
    skillSelect.innerHTML = ""; // Limpiar opciones existentes

    currentSkills.forEach((skill) => {
      const option = document.createElement("option");
      option.value = skill.name;
      option.textContent = skill.name;
      skillSelect.appendChild(option);
    });
  }

  function guardarWebhook() {
    const url = document.getElementById("webhook-url").value.trim();

    if (!url.startsWith("https://discord.com/api/webhooks/")) {
      alert("ERROR: ENLACE DE WEBHOOK NO VÁLIDO");
      return;
    }

    localStorage.setItem("discordWebhookURL", url);
    document.getElementById("webhook-form").style.display = "none";
    document.getElementById("dados-section").style.display = "block";
    document.getElementById("backwhurl").style.display = "block";

    // Limpiar campo de nombre de personaje para nueva simulación
    document.getElementById("character-name").value = "";
  }

  document.getElementById("loadJson").addEventListener("change", function (e) {
    const file = e.target.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = function (e) {
      try {
        const config = JSON.parse(e.target.result);

        // Actualizar configuración general
        if (config.config) {
          currentConfig = {
            ...currentConfig,
            ...config.config,
          };
        }

        // Actualizar habilidades
        if (config.skills && Array.isArray(config.skills)) {
          currentSkills = config.skills;
          actualizarDropdownHabilidades();
        }

        alert("Configuración personalizada cargada correctamente");
      } catch (error) {
        alert("Error: El archivo JSON no es válido\n" + error.message);
        console.error(error);
      }
    };
    reader.readAsText(file);
  });

  function copiarJsonBase() {
    const jsonBase = JSON.stringify(
      {
        config: currentConfig,
        skills: currentSkills,
      },
      null,
      2
    );

    navigator.clipboard
      .writeText(jsonBase)
      .then(() => alert("JSON base copiado al portapeles"))
      .catch((err) => console.error("Error al copiar:", err));
  }

  function determinarResultado(puntos, tirada) {
    const porcentajeExito = puntos * 20;
    const umbrales = [
      {
        max: 20,
        texto: "FALLO CRÍTICO 💥 ¡SISTEMA COLAPSADO!",
        descripcion:
          "La acción ha fallado catastróficamente con consecuencias graves.",
        clase: "critical",
      },
      {
        max: 40,
        texto: "FALLO TÉCNICO 🛠️",
        descripcion: "El intento no tuvo éxito pero sin daños colaterales.",
        clase: "failure",
      },
      {
        max: 60,
        texto: "ÉXITO PARCIAL ⚡",
        descripcion: "Logro conseguido pero con complicaciones.",
        clase: "partial",
      },
      {
        max: 80,
        texto: "ÉXITO TOTAL ✅",
        descripcion: "La operación se completó según lo planeado.",
        clase: "success",
      },
      {
        max: 100,
        texto: "ÉXITO SOBRESALIENTE 🚀",
        descripcion: "Resultado excepcional con beneficios adicionales.",
        clase: "epic",
      },
    ];

    const porcentajeReal = puntos >= 5 ? 100 : porcentajeExito;
    const porcentajeObtenido = (tirada / 20) * 100;
    const porcentajeEfectivo = (porcentajeObtenido * porcentajeReal) / 100;

    for (let umbral of umbrales) {
      if (porcentajeEfectivo <= umbral.max) {
        return {
          texto: umbral.texto,
          descripcion: umbral.descripcion,
          clase: umbral.clase,
          porcentaje: Math.round(porcentajeEfectivo),
        };
      }
    }

    return {
      texto: "ÉXITO SOBRESALIENTE 🚀",
      descripcion: "Resultado excepcional con beneficios adicionales.",
      clase: "epic",
      porcentaje: 100,
    };
  }

  async function tirarDados() {
    const webhookURL = localStorage.getItem("discordWebhookURL");
    if (!webhookURL) {
      alert("ERROR: SISTEMA NO CONFIGURADO");
      return;
    }

    const characterName = document
      .getElementById("character-name")
      .value.trim();
    if (!characterName) {
      alert("ERROR: NOMBRE NO ESPECIFICADO");
      return;
    }

    const skillPoints = parseInt(document.getElementById("skill-points").value);
    if (skillPoints < 1 || skillPoints > 6) {
      alert("ERROR: NIVEL DE HABILIDAD INVÁLIDO");
      return;
    }

    const skillName = document.getElementById("skill-name").value;
    const tirada = Math.floor(Math.random() * 20) + 1;
    const resultado = determinarResultado(skillPoints, tirada);
    const skill = currentSkills.find((s) => s.name === skillName) || {};

    // Obtener mensajes personalizados
    const resultIndex = Math.min(Math.floor(resultado.porcentaje / 20), 4);
    const skillMessage =
      skill.messages?.[resultIndex] || "Resultado no definido";
    const analysis =
      skill.analysis?.[resultIndex] || currentConfig.defaultAnalysis;
    const recommendation =
      skill.recommendations?.[resultIndex] ||
      currentConfig.defaultRecommendation;

    // Mostrar resultado local
    const resultDiv = document.getElementById("result");
    resultDiv.style.display = "block";
    resultDiv.className = resultado.clase;
    resultDiv.innerHTML = `
      <h3>📊 RESULTADO DE SIMULACIÓN</h3>
      <p><strong>${characterName}</strong> en <strong>${skillName}</strong> (Nivel ${skillPoints})</p>
      <p>🎲 Tirada: ${tirada}/20</p>
      <p>📈 Eficiencia: ${resultado.porcentaje}%</p>
      <p>💬 <strong>${skillMessage}</strong></p>
      <p>${analysis}</p>
      <p class="${resultado.clase}">${resultado.texto}</p>
      <p>► RECOMENDACIÓN: ${recommendation}</p>
    `;

    // Crear mensaje para Discord (formato mejorado)
    const discordMessage = [
      `**${currentConfig.title}**`,
      `**${currentConfig.characterLabel}:** ${characterName}`,
      `**Habilidad:** ${skillName} (Nivel ${skillPoints})`,
      `**Tirada:** ${tirada}/20 → **${resultado.texto}**`,
      `**Eficiencia:** ${resultado.porcentaje}%`,
      `**Resultado:** ${skillMessage}`,
      `**Análisis:** ${analysis}`,
      `**► RECOMENDACIÓN:** ${recommendation}`,
    ].join("\n");

    // Enviar a Discord
    try {
      const response = await fetch(webhookURL, {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify({
          content: discordMessage,
          allowed_mentions: { parse: [] },
        }),
      });

      if (!response.ok) {
        throw new Error(`Error HTTP: ${response.status}`);
      }

      console.log("Mensaje enviado con éxito a Discord");
    } catch (error) {
      console.error("Error al enviar a Discord:", error);
      alert(
        "Error al enviar a Discord. Verifica la consola para más detalles."
      );
    }
  }
</script>